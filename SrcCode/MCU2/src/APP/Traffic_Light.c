/********************************************************************************************************/
/************************************************Includes************************************************/
/********************************************************************************************************/
#include "Traffic_Light.h"
#include "HLED/LED.h"


/********************************************************************************************************/
/************************************************Defines*************************************************/
/********************************************************************************************************/
#define PERIODICITY_SEC   2000


/********************************************************************************************************/
/************************************************Types***************************************************/
/********************************************************************************************************/
typedef enum{
    GREEN=0,
    YELLOW,
    RED,
}State_tenu; 


/********************************************************************************************************/
/************************************************Variables***********************************************/
/********************************************************************************************************/
State_tenu State = GREEN;
static u8 Prev_State ;


/********************************************************************************************************/
/*****************************************Static Functions Prototype*************************************/
/********************************************************************************************************/



/********************************************************************************************************/
/*********************************************APIs Implementation****************************************/
/********************************************************************************************************/
void TrafficLights(void)
{
    static u32 Local_Sec;
    Local_Sec+=PERIODICITY_SEC;
    switch (State)
    {
    case GREEN:
    	HLED_SetStatus(LED_GREEN,LED_ON);
    	HLED_SetStatus(LED_YELLOW,LED_OFF);
    	HLED_SetStatus(LED_RED,LED_OFF);
        if(Local_Sec==6000)
        {
        	Local_Sec=0;
            State = YELLOW;
            Prev_State= GREEN;

        }
        break;
        
    case YELLOW:
    	HLED_SetStatus(LED_GREEN,LED_OFF);
    	HLED_SetStatus(LED_YELLOW,LED_ON);
    	HLED_SetStatus(LED_RED,LED_OFF);
        if(Local_Sec==2000&&Prev_State==GREEN)
        {
        	Local_Sec=0;
            State = RED;
        }
        else if(Local_Sec==2000&&Prev_State==RED)
        {
        	Local_Sec=0;
            State = GREEN;
        }
        
        break; 
    case RED:
    	HLED_SetStatus(LED_GREEN,LED_OFF);
    	HLED_SetStatus(LED_YELLOW,LED_OFF);
    	HLED_SetStatus(LED_RED,LED_ON);
        if(Local_Sec==4000)
        {
        	Local_Sec=0;
            State = YELLOW;
            Prev_State= RED;
        }
        
        break;            
    
    default:
        break;
    }

}

